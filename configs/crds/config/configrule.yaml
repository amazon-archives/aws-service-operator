---
apiVersion: apiextensions.k8s.io/v1beta1
kind: CustomResourceDefinition
metadata:
  name: configrules.config.awsoperator.io
spec:
  group: config.awsoperator.io
  versions:
  - name: v1alpha1
    served: true
    storage: true
  scope: Namespaced
  names:
    plural: configrules
    singular: configrule
    kind: ConfigRule
    shortNames: []
    categories:
    - aws
    - config
  additionalPrinterColumns:
  - name: Status
    type: string
    description: Status for the AWS CloudFormation stack.
    JSONPath: ".status.reason"
  - name: Message
    type: string
    description: Message accompanying it's current stack status.
    JSONPath: ".status.message"
    priority: 1
  - name: Created At
    type: date
    description: When the resource was created
    JSONPath: ".metadata.creationTimestamp"
  subresources:
    status: {}
  validation:
    openAPIV3Schema:
      properties:
        spec:
          description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html
          type: object
          required:
          - source
          properties:
            description:
              description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html#cfn-config-configrule-description
              type: string
            inputParameters:
              description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html#cfn-config-configrule-inputparameters
            maximumExecutionFrequency:
              description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html#cfn-config-configrule-maximumexecutionfrequency
              type: string
              enum: &1
              - One_Hour
              - Six_Hours
              - Three_Hours
              - Twelve_Hours
              - TwentyFour_Hours
            scope:
              description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html#cfn-config-configrule-scope
              type: object
              required: []
              properties:
                complianceResourceRef:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-scope.html#cfn-config-configrule-scope-complianceresourceid
                  type: string
                complianceResourceTypes:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-scope.html#cfn-config-configrule-scope-complianceresourcetypes
                  type: array
                  items:
                    type: string
                  enum:
                  - AWS::ACM::Certificate
                  - AWS::AutoScaling::AutoScalingGroup
                  - AWS::AutoScaling::LaunchConfiguration
                  - AWS::AutoScaling::ScalingPolicy
                  - AWS::AutoScaling::ScheduledAction
                  - AWS::CloudFormation::Stack
                  - AWS::CloudFront::Distribution
                  - AWS::CloudFront::StreamingDistribution
                  - AWS::CloudTrail::Trail
                  - AWS::CloudWatch::Alarm
                  - AWS::CodeBuild::Project
                  - AWS::CodePipeline::Pipeline
                  - AWS::DynamoDB::Table
                  - AWS::EC2::CustomerGateway
                  - AWS::EC2::EIP
                  - AWS::EC2::Host
                  - AWS::EC2::Instance
                  - AWS::EC2::InternetGateway
                  - AWS::EC2::NetworkAcl
                  - AWS::EC2::NetworkInterface
                  - AWS::EC2::RouteTable
                  - AWS::EC2::SecurityGroup
                  - AWS::EC2::Subnet
                  - AWS::EC2::Volume
                  - AWS::EC2::VPC
                  - AWS::EC2::VPNConnection
                  - AWS::EC2::VPNGateway
                  - AWS::ElasticBeanstalk::Application
                  - AWS::ElasticBeanstalk::ApplicationVersion
                  - AWS::ElasticBeanstalk::Environment
                  - AWS::ElasticLoadBalancing::LoadBalancer
                  - AWS::ElasticLoadBalancingV2::LoadBalancer
                  - AWS::IAM::Group
                  - AWS::IAM::Policy
                  - AWS::IAM::Role
                  - AWS::IAM::User
                  - AWS::Lambda::Function
                  - AWS::RDS::DBInstance
                  - AWS::RDS::DBSecurityGroup
                  - AWS::RDS::DBSnapshot
                  - AWS::RDS::DBSubnetGroup
                  - AWS::RDS::EventSubscription
                  - AWS::Redshift::Cluster
                  - AWS::Redshift::ClusterParameterGroup
                  - AWS::Redshift::ClusterSecurityGroup
                  - AWS::Redshift::ClusterSnapshot
                  - AWS::Redshift::ClusterSubnetGroup
                  - AWS::Redshift::EventSubscription
                  - AWS::S3::Bucket
                  - AWS::ServiceCatalog::CloudFormationProduct
                  - AWS::ServiceCatalog::CloudFormationProvisionedProduct
                  - AWS::ServiceCatalog::Portfolio
                  - AWS::Shield::Protection
                  - AWS::ShieldRegional::Protection
                  - AWS::SSM::AssociationCompliance
                  - AWS::SSM::ManagedInstanceInventory
                  - AWS::SSM::PatchCompliance
                  - AWS::WAF::RateBasedRule
                  - AWS::WAF::Rule
                  - AWS::WAF::RuleGroup
                  - AWS::WAF::WebACL
                  - AWS::WAFRegional::RateBasedRule
                  - AWS::WAFRegional::Rule
                  - AWS::WAFRegional::RuleGroup
                  - AWS::WAFRegional::WebACL
                  - AWS::XRay::EncryptionConfig
                tagKey:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-scope.html#cfn-config-configrule-scope-tagkey
                  type: string
                tagValue:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-scope.html#cfn-config-configrule-scope-tagvalue
                  type: string
            source:
              description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-config-configrule.html#cfn-config-configrule-source
              type: object
              required:
              - owner
              - sourceIdentifier
              properties:
                owner:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-source.html#cfn-config-configrule-source-owner
                  type: string
                  enum:
                  - AWS
                  - CUSTOM_LAMBDA
                sourceDetails:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-source.html#cfn-config-configrule-source-sourcedetails
                  type: array
                  items:
                    type: object
                    properties:
                      eventSource:
                        description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-source-sourcedetails.html#cfn-config-configrule-source-sourcedetail-eventsource
                        type: string
                        customAttributes:
                          template: EventSource
                          immutable: false
                        enum:
                        - aws.config
                      maximumExecutionFrequency:
                        description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-source-sourcedetails.html#cfn-config-configrule-sourcedetail-maximumexecutionfrequency
                        type: string
                        customAttributes:
                          template: MaximumExecutionFrequency
                          immutable: false
                        enum: *1
                      messageType:
                        description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-source-sourcedetails.html#cfn-config-configrule-source-sourcedetail-messagetype
                        type: string
                        customAttributes:
                          template: MessageType
                          immutable: false
                        enum:
                        - ConfigurationItemChangeNotification
                        - ConfigurationSnapshotDeliveryCompleted
                        - OversizedConfigurationItemChangeNotification
                        - ScheduledNotification
                sourceentifierRef:
                  description: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-config-configrule-source.html#cfn-config-configrule-source-sourceidentifier
                  type: string
